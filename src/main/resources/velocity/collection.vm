<html>
<head>
	<title>My Movie Collection</title>
	#parse("util/common-head.vm")

	<script type="text/javascript">
		$(document).ready(function () {
			$("#sortBy").val("$sortBy");
			#foreach($genre in $genreFilters)
				$("input[name='genreFilter'][value='$genre']").prop("checked", true);
			#end
			#foreach($medium in $mediumFilters)
				$("input[name='mediumFilter'][value='$medium.val']").prop("checked", true);
			#end
			#foreach($rating in $ratingFilters)
				$("input[name='ratingFilter'][value='$rating']").prop("checked", true);
			#end
			$("#sortBy").on("change", function () {
				$("#sortForm").submit();
			});
			$(".filter-btn").on("click", function () {
				var filterVisible = $("#filter").is(":visible");
				if (filterVisible){
					$("#filter").slideUp();
				} else {
					$("#filter").slideDown();
				}
			});
			$("#filter").hide();
			$("#reset").on("click", function(){
				$("input[type='checkbox']").prop("checked", true);
			});
		});
	</script>
</head>
<body>
	#parse("util/header.vm")
<div class="container">
	<form id="sortForm" class="form-inline" action="$WebPath.getCOLLECTION()" method="get">
		<div class="row">
			<div class="col-md-5">
				<h3>Collection: $collection.name <small>$totalNumOfMovies total movies</small></h3>
			</div>
			<div class="col-md-7 right-align">
				#if($genreFilters.size() == $genres.size()
				&& $mediumFilters.size() == $mediums.size()
				&& $ratingFilters.size() == $ratings.size())
					<button type="button" class="filter-btn btn btn-default">
						<strong>Filters</strong> -
						<small>showing all movies</small>
					</button>
				#else
					<button type="button" class="filter-btn btn btn-default">
						<strong>Filters</strong> -
						<small>Genres <span class="badge">$genreFilters.size()</span></small>
						<small>Mediums <span class="badge">$mediumFilters.size()</span></small>
						<small>Ratings <span class="badge">$ratingFilters.size()</span></small>
					</button>
				#end

				<label for="sortBy" class="padded-left">Sort By:</label>
				<select id="sortBy" name="sortBy" class="form-control">
					<option value="$Constants.getSORT_BY_TITLE()">Title</option>
					<option value="$Constants.getSORT_BY_RUNTIME_SHORT()">Runtime (short to long)</option>
					<option value="$Constants.getSORT_BY_RUNTIME_LONG()">Runtime (long to short)</option>
					<option value="$Constants.getSORT_BY_RATING()">Rating</option>
				</select>
			</div>
		</div>
		<div id="filter" hidden>
			<div>
				<label>Genres:</label>
				#foreach($genre in $genres)
					<label for="$genre" class="checkbox-inline">
						<input id="$genre" class="filterGenre" value="$genre" type="checkbox" name="genreFilter"/>
						$genre
					</label>
				#end
				<br/>
				<label>Mediums:</label>
				#foreach($medium in $mediums)
					<label for="$medium.val" class="checkbox-inline">
						<input id="$medium.val" class="filterMedium" value="$medium.val" type="checkbox" name="mediumFilter"/>
						$medium.val
					</label>
				#end
				<br/>
				<label>Ratings:</label>
				#foreach($rating in $ratings)
					<label for="$rating" class="checkbox-inline">
						<input id="$rating" class="filterMedium" value="$rating" type="checkbox" name="ratingFilter"/>
						$rating
					</label>
				#end
			</div>
			<div class="right-align vert-bottom">
				<button id="reset" type="button" class="btn btn-default btn-xs">reset filters</button>
				<input type="submit" class="btn btn-primary btn-block" value="Filter"/>
			</div>
	</form>
</div>
<div class="midline">
	<div class="line"></div>
	<div class="line-label">Showing $movies.size() movie#if($movies.size() == 0 || $movies.size() > 1)s#end</div>
</div>
<div class="movies">
	#foreach($movie in $movies)
		<div class="thumbnail movie #foreach($genre in $movie.genres)$genre#end #foreach($medium in $movie.mediums)$medium.val#end">
			<div class="caption">
				<h3>$movie.title
					<small>$movie.rating</small>
				</h3>
				<a href="$movie.posterUrl" target="_blank" class="center-align">
					Image
					<span class="glyphicon glyphicon-film"></span>
				</a>
				<p>$movie.runtime</p>
				<p class="center-align">
					#foreach($genre in $movie.genres)
						<span class="label label-default">$genre</span>
					#end
				</p>
			</div>
			<div class="center-align">
				#foreach($medium in $movie.mediums)
					<button type="button" class="btn btn-default btn-xs">
						$medium.val
						#if($medium.note)
						<span class="badge">i</span>
						#end
					</button>
				#end
			</div>
		</div>
	#end
</div>
</div>

</body>
</html>